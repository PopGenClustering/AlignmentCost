# Alignment Cost

## How to install

* Install [Python 3](https://www.python.org/downloads/).
* Open a terminal shell. E.g., [Git Bash](https://git-scm.com/downloads) shell on Windows

* To install the package without checking out the examples:

  ```pip install git+https://github.com/xr-cc/AlignmentCost```

* To install the package with the examples:
 
  Download this repository to local (by clicking the button on the top right corner

  Navigate to the directory. You should now be under the main ```AlignmentCost/``` directory.
  
  Install:
  ```
  pip install -e .
  ```

## How to use
* Run example scripts:
  ```
  bash scripts/ex_all.sh  # STRUCTURE replicates based on all loci
  ```
  ```
  bash scripts/ex_codis.sh  # STRUCTURE replicates based on CODIS loci
  ```
  These will create save four output figures in each corresponding directory:
  1. A heatmap of pairwise theoretical cost between replicates.
  2. A heatmap of pairwise empirical cost between replicates.
  3. A heatmap of the relative different between the two costs.
  4. A line plot showing all the possible permutations of clusters with respect to the first replicate and their theoretical alignment cost, together with bars showing the empirical costs from the rest of the replicates. The permutations (alignment) of the replicates w.r.t. the first one are generated by *CLUMPP*.

* Run analysis on your own data:
  ```
  python -m AlignmentCost.main -input_file PATH_TO_YOUR_FILE -R NUM_OF_REP -perm_file PATH_TO_ALIGNMENT_RESULTS -output_path PATH_TO_OUTPUT
  ```
  where 
  1. ```PATH_TO_YOUR_FILE``` points to a space-delimited input file in the same format as the exemplary file  ```data/all_indfile.txt```. It should contain 5+K columns, where K is the number of clusters in the replicates. It follows the *CLUMPP* individual input file format.
  2. ```NUM_OF_REP``` is the number of replicates
  3. ```PATH_TO_ALIGNMENT_RESULTS``` points to a space-delimited file containing the correct permutations (alignment) with respect to the first replicate. Each row corresponds to the permutation of one replicate, and each column corresponds to a cluster. The first row should always be ```1 2 ... K```. This can be extracted from the *CLUMPP* individual miscellaneous statistics file.
  4. ```PATH_TO_OUTPUT``` points to the directory where you want to save the figures.
  *Note that the paths can either be relative or absolute.
  
  Examples:
    ```
    python -m AlignmentCost.main -input_file data/all_indfile.txt -R 10 -perm_file data/all_clumpp_results.txt -output_path output/all
    ```
    ```
    python -m AlignmentCost.main --input_file="data/codis_indfile.txt" --R=10 --perm_file="data/codis_clumpp_results.txt" --output_path="output/codis" 
    ```



