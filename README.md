# Alignment Cost

## Contents

This folder contains all datasets used as examples as well as code (in a Python package ```AlignmentCost```) to perform the empirical data analysis described in the article "A Dirichlet model of alignment cost in mixed-membership unsupervised clustering". 

## Usage

### How to install

* Install [Python 3](https://www.python.org/downloads/).
* Open a terminal shell. E.g., [Git Bash](https://git-scm.com/downloads) shell on Windows, Bash Shell on Linux, or Mac Terminal on Mac.
* Install the package:
  * To install the package directly from GitHub:

    ```pip install git+https://github.com/xr-cc/AlignmentCost```

    Use ```pip show AlignmentCost``` to find out the location of the installed pakcage. 

    Navigate (using command ```ls```) to that directory.

  * To download the package from GitHub then install:
 
    Download this repository to local (by clicking the button on the top right corner)

    Navigate to the directory in the terminal (using command ```ls```). You should now be under the main ```AlignmentCost/``` directory which contains this [README.md](README.md) file.

    ```
    pip install -e .
    ```

### How to run the examples
You may reproduce the analysis on the datasets described in the article.

  * For *STRUCTURE* replicates based on the full set of 791 loci (Fig. 5):
    ```
    python -m AlignmentCost.main --param_file scripts/all_param.txt
    ```
  
  * For *STRUCTURE* replicates based on 13 CODIS loci (Fig. 6):
    ```
    python -m AlignmentCost.main --param_file scripts/codis_param.txt  
    ```
  
  These will generate 5 output figures for each dataset, corresponding to the 5 panels in the manuscript figures:
  A. The stacked bar plots of all replicates (not aligned yet).
  B. A heatmap of pairwise theoretical cost between replicates.
  C. A heatmap of pairwise empirical cost between replicates.
  D. A heatmap of the relative different between the two costs.
  E. A cost vs. permutation plot showing all the possible permutations of clusters with respect to the first replicate and their theoretical alignment cost, together with bars showing the empirical costs from the rest of the replicates. The permutations (alignment) of the replicates w.r.t. the first one are generated by *CLUMPP*.

### How to run on your own data
  ```
  python -m AlignmentCost.main --param_file PATH_TO_YOUR_OWN_PARAMETER_FILE
  ```
  PATH_TO_YOUR_OWN_PARAMETER_FILE should contain information about your own data, where 
  1. ```input_file``` points to a **space-delimited** input file in the same format as the exemplary file  [```data/all_indfile.txt```](data/all_indfile.txt). It should contain 5+K columns, where K is the number of clusters in the replicates. It follows the *CLUMPP* individual input file format. The path must be wrapped by quotes, as in the examplary file.
  2. ```perm_file``` points to a **space-delimited** file containing the correct permutations (alignment) with respect to the first replicate. Each row corresponds to the permutation of one replicate, and each column corresponds to a cluster. The first row should always be ```1 2 ... K```. This can be extracted from the *CLUMPP*. The path must be wrapped by quotes, as in the examplary file. 
  3. ```output_path``` points to the directory where you want to save your output figures. The path must be wrapped by quotes, as in the examplary file.
  4. ```R``` is the number of replicates
  5. ```vmax``` the number to specify the upper limit of the colorbar when plotting the heatmap of costs (Panel B and C). You may leave it as the default value 1.0.
  5. ```cost_vs_perm_label_above_bar``` is either ```True``` or ```False```, depending on where you want the labels of the empirical costs to be in Panel E.
  *Note that the paths can either be relative or absolute.
  
## Citation:
>
